---
- name: Verify Default Directory Layout-1
  hosts: localhost
  remote_user: root
  vars:
     ES_PACKAGE: metricbeat
     _backup_cfg: yes
     kibana_cfg: 
       server.port: 9999
       server.host: "sampleHost.domain.com"
       server.name: "Test Kibana Instance"
       kibana.defaultAppId: "dashboard"
  roles:
     - role: role_under_test
       es_instance_name: "instance1"
       beat_cfg:
          name: "{{es_instance_name}}"
          metricbeat.modules:
             - module: system
               metricsets: ["load","memory","process"]
               enabled: true
               period: 10s
               processes: ['.*']
          tags: 
            - test1
          output.console:
             enabled: true
             pretty: true


     - role: role_under_test
       es_instance_name: "instance2"
       beat_cfg:
          name: "{{es_instance_name}}"
          metricbeat.modules:
             - module: system
               metricsets: ["network","filesystem"]
               enabled: true
               period: 10s
               processes: ['.*']
          tags: 
            - test2
          output.console:
             enabled: true
             pretty: true

